---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
    const projects = await getCollection("projects");
    return projects.map((project) => ({
        params: { slug: project.slug },
        props: { project },
    }));
}

const { project } = Astro.props;
const { Content } = await render(project);
const { title, intro, type, links } = project.data;
---

<Layout title={title}>
    <article class="project-view">
        <header>
            <h1>{title}</h1>
            <p class="date">{project.data.date.toISOString().split("T")[0]}</p>
            <p class="intro">{intro}</p>
            {
                links && (
                    <nav>
                        {links.map((l: { label: string; url: string }) => (
                            <a
                                href={l.url}
                                target="_blank"
                                role="button"
                                class="secondary outline"
                            >
                                {l.label}
                            </a>
                        ))}
                    </nav>
                )
            }
        </header>

        <section class="content">
            <Content />
        </section>
    </article>
</Layout>

<style>
    .project-view {
        max-width: 800px;
        margin: 0 auto;
    }
    .intro {
        font-style: italic;
        color: var(--pico-muted-color);
        margin-bottom: var(--pico-spacing);
    }
    .content {
        line-height: 1.6;
    }
</style>
